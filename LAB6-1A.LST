LAB6-1A                                                                                                       PAGE 1

                       1    $MOD52
                       2    
                       3    ;–î–∞–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –∞–Ω–∞–ª–æ–≤–æ–≥–æ–π –∏–Ω
                                                                               —Ñ–æ—Ä–º–∞—Ü–∏–∏
                       4    ;–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ –ø–æ –∫–∞–∂–¥–æ–º—É –∏–∑ 8 –∫–∞–Ω–∞–ª–æ–≤ (–ø–æ –æ–¥–Ω–æ–º—É
                                                                                –æ—Ç—Å—á—ë—Ç—É);
                       5    ;–Ω–∞—Ö–æ–¥–∏—Ç –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏—è. –ú–∞–∫—
                                                                               Å–∏–º–∞–ª—å–Ω–æ–µ
                       6    ;–∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –≤ –ø–æ—Ä—Ç—ã P0 –∏ P1 (P1.0 - P1.3),
                       7    ;–º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ - –≤ –ø–æ—Ä—Ç—ã P2 –∏ P1 (P1.4 - P1.7).
                       8    ;–ó–∞–ø—É—Å–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ –ø–æ –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø—Ä–µ–¥—ã
                                                                               –¥—É—â–µ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
                                                                                –≤ —Ä–µ–∂–∏–º–µ —Å–ª–µ–∂–µ–Ω–∏—è
                       9    
  00EF                10    ADCCON1 EQU 0EFh
  00D8                11    ADCCON2 EQU 0D8h
  00F5                12    ADCCON3 EQU 0F5h
                      13    
  00D9                14    ADCDATAL EQU 0D9h
  00DA                15    ADCDATAH EQU 0DAh 
                      16    
                      17    ;–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∏ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ —Å—á–∏—Ç–∞–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
  0030                18    MINL EQU 30h
  0031                19    MINH EQU 31h
  0032                20    MAXL EQU 32h
  0033                21    MAXH EQU 33h
                      22    
                      23    ;–ß–∏—Å–ª–æ –∫–∞–Ω–∞–ª–æ–≤
  0008                24    CHANNEL_NUMBER EQU 08h
                      25    
0000                  26    ORG 00h
0000                  27    start:
                      28            ;–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ê–¶–ü
                      29            ;–†–∞–±–æ—Ç–∞ –≤ –¥–µ–∂—É—Ä–Ω–æ–º —Ä–µ–∂–∏–º–µ
0000 75EF80           30            mov ADCCON1, #80h
0003 75D800           31            mov ADCCON2, #00h
                      32            
0006 7830             33            mov R0, #MINL
0008 76FF             34            mov @R0, #0FFh
000A 7831             35            mov R0, #MINH
000C 76FF             36            mov @R0, #0FFh
                      37            
000E 7832             38            mov R0, #MAXL
0010 7600             39            mov @R0, #00h
0012 7833             40            mov R0, #MAXH
0014 7600             41            mov @R0, #00h
                      42            
                      43            ;–°—á—ë—Ç—á–∏–∫ —á–∏—Å–ª–∞ –∫–∞–Ω–∞–ª–æ–≤
0016 7A00             44            mov R2, #00h
                      45            
0018                  46    continue:
                      47            ;–§–æ—Ä–º–∏—Ä—É–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞ ADCCON2
0018 7410             48            mov A, #10h
001A 4A               49            orl A, R2
001B F5D8             50            mov ADCCON2, A
                      51            
                      52            ;–ñ–¥—ë–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è
001D                  53    wait_for_conversion:
LAB6-1A                                                                                                       PAGE 2

001D E5F5             54            mov A, ADCCON3
001F 5480             55            anl A, #080h; –í—ã–¥–µ–ª—è–µ–º —Ñ–ª–∞–≥ busy
0021 C3               56            clr C
0022 9480             57            subb A, #080h; –°–±—Ä–æ—à–µ–Ω –ª–∏ —Ñ–ª–∞–≥ busy
0024 60F7             58            jz wait_for_conversion
                      59            
                      60            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–
                                                                               ∏–Ω–∏–º–∞–ª—å–Ω—ã–º
                      61            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç
0026 E5DA             62            mov A, ADCDATAH
0028 540F             63            anl A, #0Fh
002A F9               64            mov R1, A
002B C3               65            clr C
002C 7831             66            mov R0, #MINH
002E E6               67            mov A, @R0
002F 99               68            subb A, R1
0030 4019             69            jc check_max; –ï—Å–ª–∏ —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏
                                                                               —è –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω —Å—Ç–∞—
                                                                               Ä—à–µ–º—É –±–∞–π—Ç—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ
                                                                               –≥–æ, –Ω–µ –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º –ø—Ä–æ–≤–
                                                                               µ—Ä–∫—É
0032 700B             70            jnz save_min
                      71            
                      72            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º –º–ª–∞–¥—à–∏–π –±–∞–π—Ç
0034 C3               73            clr C
0035 A9D9             74            mov R1, ADCDATAL
0037 7830             75            mov R0, #MINL
0039 E6               76            mov A, @R0
003A 99               77            subb A, R1
003B 400E             78            jc check_max; –ï—Å–ª–∏ –º–ª–∞–¥—à–∏–π –±–∞–π—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏
                                                                               —è –±–æ–ª—å—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω —Å—Ç–∞—
                                                                               Ä—à–µ–º—É –±–∞–π—Ç—É –º–∏–Ω–∏–º–∞–ª—å–Ω–æ
                                                                               –≥–æ,
003D 600C             79            jz check_max; —Ç–æ –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
                      80    
003F                  81    save_min:       
                      82            ;–ó–∞–ø–∏—Å—ã–≤–∞–µ–º –º–ª–∞–¥—à–∏–π –±–∞–π—Ç
003F E5D9             83            mov A, ADCDATAL
0041 7830             84            mov R0, #MINL
0043 F6               85            mov @R0, A
                      86            
                      87            ;–ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç
0044 7831             88            mov R0, #MINH
0046 E5DA             89            mov A, ADCDATAH
0048 540F             90            anl A, #0Fh
004A F6               91            mov @R0, A
                      92            
004B                  93    check_max:
                      94            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º, —è–≤–ª—è–µ—Ç—Å—è –ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–
                                                                               ∏–Ω–∏–º–∞–ª—å–Ω—ã–º
                      95            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç
004B E5DA             96            mov A, ADCDATAH
004D 540F             97            anl A, #0Fh
004F F9               98            mov R1, A
0050 C3               99            clr C
0051 7833            100            mov R0, #MAXH
0053 E6              101            mov A, @R0
0054 99              102            subb A, R1
LAB6-1A                                                                                                       PAGE 3

0055 4009            103            jc save_max; –ï—Å–ª–∏ —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—
                                                                               è –æ–∫–∞–∑–∞–ª—Å—è –±–æ–ª—å—à–µ —Å—Ç–∞—Ä—
                                                                               à–µ–≥–æ –±–∞–π—Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ
                                                                               –≥–æ
                     104            
                     105            ;–ü—Ä–æ–≤–µ—Ä—è–µ–º –º–ª–∞–¥—à–∏–π –±–∞–π—Ç
0057 C3              106            clr C
0058 A9D9            107            mov R1, ADCDATAL
005A 7832            108            mov R0, #MAXL
005C E6              109            mov A, @R0
005D 99              110            subb A, R1
005E 500C            111            jnc prepare_for_next_val; –ï—Å–ª–∏ –º–ª–∞–¥—à–∏–π –±–∞–π—Ç –ø–æ–ª—É—á–µ–Ω–Ω–æ–≥–æ –∑
                                                                               –Ω–∞—á–µ–Ω–∏—è –æ–∫–∞–∑–∞–ª—Å—è –º–µ–Ω—å—
                                                                               à–∏–º –∏–ª–∏ —Ä–∞–≤–Ω—ã–º –º–ª–∞–¥—à–µ–º—
                                                                               É –±–∞–π—Ç—É –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ
                     112            
0060                 113    save_max:
                     114            ;–ó–∞–ø–∏—Å—ã–≤–∞–µ–º –º–ª–∞–¥—à–∏–π –±–∞–π—Ç
0060 E5D9            115            mov A, ADCDATAL
0062 7832            116            mov R0, #MAXL
0064 F6              117            mov @R0, A
                     118            
                     119            ;–ó–∞–ø–∏—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ä—à–∏–π –±–∞–π—Ç
0065 7833            120            mov R0, #MAXH
0067 E5DA            121            mov A, ADCDATAH
0069 540F            122            anl A, #0Fh
006B F6              123            mov @R0, A
                     124    
006C                 125    prepare_for_next_val:
006C 0A              126            inc R2
006D C3              127            clr C
006E EA              128            mov A, R2
006F 9408            129            subb A, #08h
0071 70A5            130            jnz continue
                     131            
                     132    ;–í—ã–≤–æ–¥–∏–º –º–∏–Ω–∏–º—É–º –∏ –º–∞–∫—Å–∏–º—É–º –≤ –ø–æ—Ä—Ç—ã
0073 7830            133            mov R0, #MINL
0075 E6              134            mov A, @R0
0076 F580            135            mov P0, A
                     136            
0078 7831            137            mov R0, #MINH
007A E6              138            mov A, @R0
007B 540F            139            anl A, #0Fh
007D F9              140            mov R1, A
                     141            
007E 7833            142            mov R0, #MAXH
0080 E6              143            mov A, @R0
0081 540F            144            anl A, #0Fh
0083 75F010          145            mov B, #010h
0086 A4              146            mul AB
0087 49              147            orl A, R1
0088 F590            148            mov P1, A
                     149            
008A 7832            150            mov R0, #MAXL
008C E6              151            mov A, @R0
008D F5A0            152            mov P2, A
                     153            
                     154    ;–ö–æ–Ω–µ—Ü –ø—Ä–æ–≥—Ä–∞–º–º—ã
LAB6-1A                                                                                                       PAGE 4

008F                 155    lp:
008F 80FE            156            jmp lp
                     157    
                     158    END

VERSION 1.2h ASSEMBLY COMPLETE, 0 ERRORS FOUND
LAB6-1A                                                                                                       PAGE 5

ADCCON1. . . . . . . . . . . . .    NUMB  00EFH  
ADCCON2. . . . . . . . . . . . .    NUMB  00D8H  
ADCCON3. . . . . . . . . . . . .    NUMB  00F5H  
ADCDATAH . . . . . . . . . . . .    NUMB  00DAH  
ADCDATAL . . . . . . . . . . . .    NUMB  00D9H  
B. . . . . . . . . . . . . . . .  D ADDR  00F0H  PREDEFINED  
CHANNEL_NUMBER . . . . . . . . .    NUMB  0008H  NOT USED  
CHECK_MAX. . . . . . . . . . . .  C ADDR  004BH  
CONTINUE . . . . . . . . . . . .  C ADDR  0018H  
LP . . . . . . . . . . . . . . .  C ADDR  008FH  
MAXH . . . . . . . . . . . . . .    NUMB  0033H  
MAXL . . . . . . . . . . . . . .    NUMB  0032H  
MINH . . . . . . . . . . . . . .    NUMB  0031H  
MINL . . . . . . . . . . . . . .    NUMB  0030H  
P0 . . . . . . . . . . . . . . .  D ADDR  0080H  PREDEFINED  
P1 . . . . . . . . . . . . . . .  D ADDR  0090H  PREDEFINED  
P2 . . . . . . . . . . . . . . .  D ADDR  00A0H  PREDEFINED  
PREPARE_FOR_NEXT_VAL . . . . . .  C ADDR  006CH  
SAVE_MAX . . . . . . . . . . . .  C ADDR  0060H  
SAVE_MIN . . . . . . . . . . . .  C ADDR  003FH  
START. . . . . . . . . . . . . .  C ADDR  0000H  NOT USED  
WAIT_FOR_CONVERSION. . . . . . .  C ADDR  001DH  
